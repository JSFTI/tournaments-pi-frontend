import{_ as Y,d as T,r as C,a as M,o as d,c as g,b as h,F as W,e as U,t as V,u as s,n as O,f as H,w as X,g as R,h as k,i as N,j as S,k as q,v as G,l as I,m as Z,p as ee,q as E,s as te,x as z,y as le,z as ne,A as Q}from"./index.8cc14814.js";const ae=["id","name","value"],re=["value"],ie=T({props:{modelValue:null,label:null,name:null,id:null,invalidFeedback:null,placeholder:null,style:null,options:null},emits:["update:modelValue"],setup(i){const u=i,t=C(!1),r=M(()=>u.placeholder?[{value:null,label:u.placeholder},...u.options]:u.options);return(a,e)=>(d(),g("div",{class:"input-group-wrapper",style:H(i.style)},[h("div",{class:O(["input-group",{[t.value?"focused":"blurred"]:!0}])},[h("select",{id:i.id,name:i.name,value:i.modelValue,"bg-transparent":"",onFocusin:e[0]||(e[0]=n=>t.value=!0),onFocusout:e[1]||(e[1]=n=>t.value=!1),onChange:e[2]||(e[2]=n=>a.$emit("update:modelValue",n.target.value))},[(d(!0),g(W,null,U(s(r),n=>{var _;return d(),g("option",{key:(_=n.value)!=null?_:"placeholder","text-1rem":"",value:n.value},V(n.label),9,re)}),128))],40,ae)],2)],4))}});var se=Y(ie,[["__scopeId","data-v-3d9a6703"]]);const oe={flex:"","flex-col":""},ue=["id","value"],de=["for"],ce=["id","value"],pe=["for"],me=N(" Edit Bracket "),he=T({props:{selected:null,addedPlayers:null,remainingPlayers:null},emits:["close","fill","switch"],setup(i,{emit:u}){const t=i,r=C("switch-player"),a=C(null),e=C(null);function n(){a.value=e.value=null,u("close")}function _(){if(a.value){const p=t.remainingPlayers.find(m=>m.id===a.value);p&&(u("fill",p),a.value=e.value=null)}else if(e.value){const p=t.addedPlayers.find(m=>m.id===e.value);p&&(u("switch",p),a.value=e.value=null)}}const y=M(()=>t.addedPlayers.filter(p=>{var m,f;return p.id!==((f=(m=t.selected)==null?void 0:m.player)==null?void 0:f.id)}));return X(()=>r.value,()=>{a.value=e.value=null}),(p,m)=>{const f=se,w=I,x=Z;return d(),R(x,{show:!!i.selected,"is-form":"",onClose:n,onSubmit:_},{title:k(()=>{var l;return[N(V((l=i.selected)!=null&&l.player?"Switch":"Fill")+" Bracket With \xA0",1),S(f,{id:"modal-type",modelValue:r.value,"onUpdate:modelValue":m[0]||(m[0]=c=>r.value=c),name:"modalType",style:{marginTop:0,marginBottom:0},options:[{label:"Switch Player",value:"switch-player"},{label:"Remaining Players",value:"remaining-player"}]},null,8,["modelValue"])]}),footer:k(()=>[S(w,{class:"btn btn-brand-primary",type:"submit"},{default:k(()=>[me]),_:1})]),default:k(()=>[h("div",oe,[r.value==="switch-player"?(d(!0),g(W,{key:0},U(s(y),l=>{var c;return d(),g("div",{key:(c=l.id)!=null?c:0,"py-2":"","pl-3":"",flex:"","gap-3":"",class:O({"dark:bg-dark-300 bg-light-800":e.value===l.id})},[q(h("input",{id:`added-modal-${l.id}`,"onUpdate:modelValue":m[1]||(m[1]=o=>e.value=o),type:"radio",name:"addedPlayerModal",value:l.id},null,8,ue),[[G,e.value]]),h("label",{for:`added-modal-${l.id}`},V(l.name),9,de)],2)}),128)):(d(!0),g(W,{key:1},U(i.remainingPlayers,l=>{var c;return d(),g("div",{key:(c=l.id)!=null?c:0,"py-2":"","pl-3":"",flex:"","gap-3":"",class:O({"dark:bg-dark-300 bg-light-800":a.value===l.id})},[q(h("input",{id:`remaining-modal-${l.id}`,"onUpdate:modelValue":m[2]||(m[2]=o=>a.value=o),type:"radio",name:"remainingPlayerModal",value:l.id},null,8,ce),[[G,a.value]]),h("label",{for:`remaining-modal-${l.id}`},V(l.name),9,pe)],2)}),128))])]),_:1},8,["show"])}}}),ye=h("h2",null,"Remaining Players",-1),ge={flex:"","flex-col":""},ve=["id","value"],fe=["for"],_e={flex:"","gap-3":""},ke=N(" Cancel "),be=N(" Randomize "),$e=T({props:{players:null},emits:["changedSelection","randomizePlayers"],setup(i,{emit:u}){const t=i,r=C(null);return X(()=>r.value,()=>{var a;u("changedSelection",(a=t.players.find(e=>e.id===r.value))!=null?a:null)}),(a,e)=>{const n=I,_=ee;return d(),R(_,{"w-75":""},{title:k(()=>[ye]),footer:k(()=>[h("div",_e,[S(n,{class:"btn btn-theme-danger",disabled:!r.value,onClick:e[1]||(e[1]=y=>r.value=null)},{default:k(()=>[ke]),_:1},8,["disabled"]),S(n,{class:"btn btn-theme-warning",onClick:e[2]||(e[2]=y=>a.$emit("randomizePlayers"))},{default:k(()=>[be]),_:1})])]),default:k(()=>[h("div",ge,[(d(!0),g(W,null,U(i.players,y=>{var p;return d(),g("div",{key:(p=y.id)!=null?p:0,"py-2":"","pl-3":"",flex:"","gap-3":"",class:O({"dark:bg-dark-300 bg-light-800":r.value===y.id})},[q(h("input",{id:`remaining-${y.id}`,"onUpdate:modelValue":e[0]||(e[0]=m=>r.value=m),type:"radio",name:"remainingPlayer",value:y.id},null,8,ve),[[G,r.value]]),h("label",{for:`remaining-${y.id}`},V(y.name),9,fe)],2)}),128))])]),_:1})}}}),Pe=["height","viewBox"],we=["d"],xe=["height","viewBox"],Be=["transform","d"],Se=T({props:{height:null,direction:null},setup(i){const u=i,t=M(()=>u.height/2),r=M(()=>{const a={right:"-40px"};return a[u.direction==="down"?"top":"bottom"]=`${u.height-5}px`,a});return(a,e)=>(d(),g("div",{absolute:"",style:H(s(r))},[i.direction==="down"?(d(),g("svg",{key:0,width:"40",height:s(t)*2,viewBox:`0 0 40 ${s(t)*2}`,fill:"none",xmlns:"http://www.w3.org/2000/svg","dark:stroke-white":"","stroke-gray":""},[h("path",{d:`
          M 0 0
          c 20 0 20 ${s(t)} 20 ${s(t)}
          c 0 ${s(t)} 20 ${s(t)} 20 ${s(t)}`,"stroke-width":"2"},null,8,we)],8,Pe)):(d(),g("svg",{key:1,height:s(t)*2,viewBox:`0 0 40 ${s(t)*2}`,fill:"none",xmlns:"http://www.w3.org/2000/svg","dark:stroke-white":"","stroke-gray":"","stroke-width":"2"},[h("path",{transform:`scale(1, -1) translate(0, -${s(t)*2})`,d:`
          M 0 0
          c 20 0 20 ${s(t)} 20 ${s(t)}
          c 0 ${s(t)} 20 ${s(t)} 20 ${s(t)}`},null,8,Be)],8,xe))],4))}}),Ce=T({props:{bracket:null,isLastRound:{type:Boolean},inputingPlayer:null,tournamentStarted:{type:Boolean}},emits:["placedPlayer","fillWithPlayer"],setup(i,{emit:u}){const t=i,r=C(!1);function a(){var y,p;if(t.inputingPlayer&&((y=t.bracket)==null?void 0:y.match)===null){r.value=!0,u("placedPlayer",t.inputingPlayer,t.bracket.id,()=>{r.value=!1});return}((p=t.bracket)==null?void 0:p.match)===null&&e()}function e(){u("fillWithPlayer",t.bracket)}const n=M(()=>({visibility:t.bracket===null?"hidden":"visible",pointerEvents:t.bracket===null?"none":"auto"})),_=M(()=>{var f,w,x;const y="dark:bg-dark-400 bg-gray-500",p="hover:dark:bg-dark-200 hover:bg-gray-400 cursor-pointer",m="dark:bg-dark-300 bg-gray-300";return t.tournamentStarted?((f=t.bracket)==null?void 0:f.match)===null?y.split(" "):[]:t.inputingPlayer&&((w=t.bracket)==null?void 0:w.match)===null?`${m} ${p}`.split(" "):((x=t.bracket)==null?void 0:x.match)===null?`${m} ${p}`.split(" "):y.split(" ")});return(y,p)=>{var m,f;return d(),g("div",{class:O(["color-black dark:color-white flex items-center px-3 transition",s(_)]),style:H(s(n)),onClick:a},[h("span",null,V((f=(m=i.bracket)==null?void 0:m.player)==null?void 0:f.name),1)],6)}}}),Fe=T({props:{round:null,roundNum:null,inputingPlayer:null,tournamentStarted:{type:Boolean}},emits:["placedPlayer","fillWithPlayer"],setup(i){function a(e){return e<=0?40:a(e-1)*2+10}return(e,n)=>{const _=Ce,y=Se;return d(),g("div",{flex:"","flex-col":"",style:H({gap:`${10}px`})},[(d(!0),g(W,null,U(i.round,(p,m)=>{var f;return d(),g("div",{key:(f=p==null?void 0:p.id)!=null?f:m,grid:"","place-items-center":"",style:H({height:`${a(i.roundNum)}px`}),relative:""},[S(_,{"tournament-started":i.tournamentStarted,"inputing-player":i.inputingPlayer,style:H({height:`${40}px`,width:`${225}px`}),bracket:p,"is-last-round":i.round.length===1,onPlacedPlayer:n[0]||(n[0]=(w,x,l)=>e.$emit("placedPlayer",w,x,l)),onFillWithPlayer:w=>e.$emit("fillWithPlayer",w)},null,8,["tournament-started","inputing-player","style","bracket","is-last-round","onFillWithPlayer"]),p!==null&&i.round.length>1?(d(),R(y,{key:0,height:a(i.roundNum)/2+10/2,direction:m%2===0?"down":"up"},null,8,["height","direction"])):E("",!0)],4)}),128))],4)}}}),Re={flex:"","gap-40px":"","overflow-auto":""},Ve=T({props:{rounds:null,inputingPlayer:null,tournamentStarted:{type:Boolean}},emits:["placedPlayer","fillWithPlayer"],setup(i){return(u,t)=>{const r=Fe;return d(),g("div",Re,[(d(!0),g(W,null,U(i.rounds,(a,e)=>(d(),R(r,{key:e,"inputing-player":i.inputingPlayer,round:a,"round-num":+e,"tournament-started":i.tournamentStarted,onPlacedPlayer:t[0]||(t[0]=(n,_,y)=>u.$emit("placedPlayer",n,_,y)),onFillWithPlayer:t[1]||(t[1]=n=>u.$emit("fillWithPlayer",n))},null,8,["inputing-player","round","round-num","tournament-started"]))),128))])}}});function L(i,u,t="id"){let r=[i],a=[];for(;r.length>0;){const e=r[0];if(e[t]===u)return e;e&&e.prev_match&&(e.prev_match.left&&a.push(e.prev_match.left),e.prev_match.right&&a.push(e.prev_match.right)),r.shift(),r.length===0&&a.length>0&&(r=[...a],a=[])}return null}const We={container:"","mx-auto":"","px-4":""},Te={class:"flex items-center text-2xl gap-2"},ze=h("hr",{class:"my-4"},null,-1),Me={class:"flex"},Ne=N(" Configure Players "),je=h("div",{"i-carbon-user-multiple":""},null,-1),Ee={class:"flex gap-5"},He=N(" Start Tournament "),Ue={flex:"","gap-3":"","mt-5":""},Oe=T({props:{tournament:null},setup(i){const u=i,t=ne(),r=C(null),a=C(null),e=C(null),n=te({brackets:null,added_players:[],remaining_players:[],total_players:0,total_rounds:0});z.get(`/tournaments/${u.tournament}`).then(l=>{r.value=l.data,z.get(`/tournaments/${u.tournament}/brackets`).then(c=>{if(c.status===204){n.brackets={};return}Object.assign(n,c.data)})});function _(){z.put(`/tournaments/${u.tournament}/brackets?empty=true`).then(l=>{Object.assign(n,l.data)})}function y(){z.put(`/tournaments/${u.tournament}/brackets`).then(l=>{Object.assign(n,l.data)})}function p(l,c,o){z.put(`/brackets/${c}/player`,{player_id:l.id}).then(()=>{var b,$;const v=L(n.brackets,c);v&&(v.player_id=l.id,v.player=l),n.remaining_players=(b=n.remaining_players)==null?void 0:b.filter(P=>P.id!==l.id),($=n.added_players)==null||$.push(l),a.value=null,o()})}function m(l){e.value=l}function f(l){e.value&&z.put(`/brackets/${e.value.id}/player`,{player_id:l.id}).then(c=>{var v,b,$;const o=L((v=n.brackets)!=null?v:{},e.value.id);o&&(o.player=l,o.player_id=l.id,e.value=null,(b=n.added_players)==null||b.push(l),n.remaining_players=($=n.remaining_players)==null?void 0:$.filter(P=>P.id!==l.id))})}function w(l){e.value&&z.put(`/brackets/${e.value.id}/player`,{player_id:l.id}).then(c=>{var b,$,P,F;const o=L((b=n.brackets)!=null?b:{},e.value.id),v=L(($=n.brackets)!=null?$:{},l.id,"player_id");o&&v&&(o.player_id=v.player_id,o.player=v.player,v.player_id=(P=e.value)==null?void 0:P.player_id,v.player=(F=e.value)==null?void 0:F.player,e.value=null)})}const x=M(()=>{var b,$,P,F,D,j,J,K;if(!n.brackets||Q.exports.isEmpty(n.brackets))return[];let l=[n.brackets],c=[];const o=[[]];let v=0;for(;l.length>0;){const B=Q.exports.cloneDeep(l[0]);B?(c.push(($=(b=B.prev_match)==null?void 0:b.left)!=null?$:null,(F=(P=B.prev_match)==null?void 0:P.right)!=null?F:null),o[v].push(B)):o[v].push(null),l.shift(),l.length===0&&c.length>0&&(v++,o.push([]),l=[...c],c=[])}o.pop();for(let B=0;B<o.length;B++)for(let A=0;A<o[B].length;A++)(j=(D=o[B][A])==null?void 0:D.prev_match)==null||delete j.left.prev_match,(K=(J=o[B][A])==null?void 0:J.prev_match)==null||delete K.right.prev_match;return o.reverse(),o});return(l,c)=>{var F,D;const o=I,v=le("router-link"),b=Ve,$=$e,P=he;return d(),g(W,null,[h("div",We,[r.value?(d(),g(W,{key:0},[h("div",Te,[h("button",{"i-carbon-caret-left":"",onClick:c[0]||(c[0]=j=>s(t).back())}),h("h1",null,V(r.value.name),1)]),ze,h("div",Me,[S(v,{class:"mr-auto",to:`/tournaments/${r.value.id}/players`},{default:k(()=>[S(o,{class:"btn btn-brand-primary md:block hidden"},{default:k(()=>[Ne]),_:1}),S(o,{class:"btn btn-brand-primary md:hidden block h-3rem w-3rem"},{default:k(()=>[je]),_:1})]),_:1},8,["to"]),h("div",Ee,[s(n).brackets!==null?(d(),R(o,{key:0,class:"btn",onClick:_},{default:k(()=>[N(V(s(x).length>0?"Recreate":"Create")+" Brackets ",1)]),_:1})):E("",!0),r.value.started?E("",!0):(d(),R(o,{key:1,class:"btn btn-theme-warning"},{default:k(()=>[He]),_:1}))])]),h("div",Ue,[s(x).length>0?(d(),R(b,{key:0,"mt-10":"",rounds:s(x),"flex-grow":"","inputing-player":a.value,"tournament-started":!!r.value.started,onPlacedPlayer:p,onFillWithPlayer:m},null,8,["rounds","inputing-player","tournament-started"])):E("",!0),!r.value.started&&s(n).remaining_players&&s(n).remaining_players.length>0?(d(),R($,{key:1,players:s(n).remaining_players,onRandomizePlayers:y,onChangedSelection:c[1]||(c[1]=j=>a.value=j)},null,8,["players"])):E("",!0)])],64)):E("",!0)]),S(P,{selected:e.value,"added-players":(F=s(n).added_players)!=null?F:[],"remaining-players":(D=s(n).remaining_players)!=null?D:[],onClose:c[2]||(c[2]=j=>e.value=null),onFill:f,onSwitch:w},null,8,["selected","added-players","remaining-players"])],64)}}});export{Oe as default};
