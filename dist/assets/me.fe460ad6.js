import{_ as Q,d as B,r as C,a as S,b as W,e as A,n as z,w as k,o as _,c as y,f as h,g as X,v as Y,u as s,h as Z,t as N,i as O,j as ee,p as te,k as ne,l as j,m as f,q as $,s as i,x as M,y as I,z as R,F as P,A as oe,B as ae,C as se,D as V,E as le,G as E,H as ue}from"./index.da93b4f5.js";import{l as F}from"./lodash.dd9bff61.js";const re=p=>(te("data-v-477045bb"),p=p(),ne(),p),ie={class:"input-group-wrapper"},de={key:0},me=re(()=>h("div",{class:"invalid-feedback"},null,-1)),ce=B({props:{modelValue:{default:""},autosize:{type:Boolean,default:!0},minHeight:{default:null},maxHeight:{default:null},important:{type:[Boolean,Array],default:!1},label:null,id:{default:""},name:{default:""}},emits:["update:modelValue"],setup(p,{emit:v}){const n=p,t=C({val:"",maxHeightScroll:!1,height:"auto",focused:!1}),d=S();t.val=n.modelValue,W(()=>{a()});const g=A(()=>{const e=n.important;return e===!0||Array.isArray(e)&&e.includes("resize")}),o=A(()=>{const e=n.important;return e===!0||Array.isArray(e)&&e.includes("overflow")}),m=A(()=>{const e=n.important;return e===!0||Array.isArray(e)&&e.includes("height")});function a(){const e=m.value?"important":"";t.height=`auto${e?" !important":""}`,z(()=>{let r=d.value.scrollHeight+1;n.minHeight&&(r=r<n.minHeight?n.minHeight:r),n.maxHeight&&(r>n.maxHeight?(r=n.maxHeight,t.maxHeightScroll=!0):t.maxHeightScroll=!1);const b=`${r}px`;t.height=`${b}${e?" !important":""}`})}const w=A(()=>n.autosize?{resize:g.value?"none":"none !important",height:t.height,overflow:t.maxHeightScroll?"auto":o.value?"hidden !important":"hidden"}:{});return k(()=>n.modelValue,()=>{t.val=n.modelValue}),k(()=>t.val,e=>{z(a),v("update:modelValue",e)}),k(()=>n.minHeight,()=>{z(a)}),k(()=>n.maxHeight,()=>{z(a)}),k(()=>n.autosize,e=>{e&&a()}),(e,r)=>(_(),y("div",ie,[h("div",{class:ee(["input-group",{"has-value":s(t).val,[s(t).focused?"focused":"blurred"]:!0}])},[X(h("textarea",{ref_key:"textarea",ref:d,"onUpdate:modelValue":r[0]||(r[0]=b=>s(t).val=b),style:Z(s(w)),rows:"1",onFocus:a,onFocusin:r[1]||(r[1]=b=>s(t).focused=!0),onFocusout:r[2]||(r[2]=b=>s(t).focused=!1)},null,36),[[Y,s(t).val]]),p.label?(_(),y("label",de,N(p.label),1)):O("",!0)],2),me]))}});var pe=Q(ce,[["__scopeId","data-v-477045bb"]]);const _e={class:"flex"},fe=$(" Submit Tournament "),he=B({props:{tournament:null},emits:["submit"],setup(p,{emit:v}){var o;const n=p,t=S(!1),d=C((o=n.tournament)!=null?o:{id:null,name:"",description:""});function g(){t.value=!0,v("submit",d,()=>{t.value=!1})}return k(()=>n.tournament,()=>{var m;Object.assign(d,(m=n.tournament)!=null?m:{id:null,name:"",description:""})},{deep:!0}),(m,a)=>{const w=M,e=pe,r=I,b=R;return _(),j(b,{"is-form":"",onSubmit:g},{title:f(()=>[$(N(s(d).id?"Edit":"Add")+" Tournament ",1)]),footer:f(()=>[h("div",_e,[i(r,{class:"ml-auto btn btn-brand-primary",type:"submit",loading:t.value},{default:f(()=>[fe]),_:1},8,["loading"])])]),default:f(()=>[i(w,{modelValue:s(d).name,"onUpdate:modelValue":a[0]||(a[0]=T=>s(d).name=T),label:"Tournament Title",type:"text",name:"name"},null,8,["modelValue"]),i(e,{modelValue:s(d).description,"onUpdate:modelValue":a[1]||(a[1]=T=>s(d).description=T),label:"Tournament Description",rows:"1",class:"text-black"},null,8,["modelValue"])]),_:1})}}}),ve=$(" Change Password "),ge=$(" Change Password "),we=$(" Change Password "),be=B({emits:["submit"],setup(p,{emit:v}){const n=S(!1),t=C({oldPassword:"",password:"",password_confirmation:""});function d(){v("submit",t,()=>{n.value=!1})}return(g,o)=>{const m=I,a=M,w=R;return _(),y(P,null,[i(m,{class:"btn btn-theme-danger block my-4",onClick:o[0]||(o[0]=e=>n.value=!0)},{default:f(()=>[ve]),_:1}),i(w,{show:n.value,"is-form":"",onClose:o[4]||(o[4]=e=>n.value=!1),onSubmit:d},{title:f(()=>[ge]),footer:f(()=>[i(m,{class:"btn btn-theme-danger",type:"submit"},{default:f(()=>[we]),_:1})]),default:f(()=>[i(a,{id:"change-password__old-password",modelValue:s(t).oldPassword,"onUpdate:modelValue":o[1]||(o[1]=e=>s(t).oldPassword=e),type:"password",name:"oldPassword",label:"Old Password"},null,8,["modelValue"]),i(a,{id:"change-password__new-password",modelValue:s(t).password,"onUpdate:modelValue":o[2]||(o[2]=e=>s(t).password=e),type:"password",name:"newPassword",label:"Password"},null,8,["modelValue"]),i(a,{id:"change-password__confirm-password",modelValue:s(t).password_confirmation,"onUpdate:modelValue":o[3]||(o[3]=e=>s(t).password_confirmation=e),type:"password",name:"confirmPassword",label:"Confirm Password"},null,8,["modelValue"])]),_:1},8,["show"])],64)}}}),xe={container:"","mx-auto":""},ye=h("h1",{class:"text-2xl"}," My Profile ",-1),Ve=h("hr",{"my-3":""},null,-1),$e=["onSubmit"],ke=$(" Edit "),Se=h("h2",{class:"text-2xl"}," My Tournaments ",-1),Te=h("hr",{"my-3":""},null,-1),He={class:"text-center"},Pe=$(" Add Tournament "),Ce={class:"mt-5 flex flex-col items-center gap-5"},Ae={key:1,"text-center":""},Me=B({setup(p){const v=oe(),n=ae(),t=se(),d=S(!0),g=S(!1),o=S({username:"",email:""}),m=C({id:null,name:"",description:""}),a=C({count:0,next_page:null,prev_page:null,results:null,total_pages:0});v.id?w():(d.value=!1,n.replace("/")),v.$subscribe((l,u)=>{u.id||(n.push("/"),d.value=!1),w()});function w(){V.get("/me").then(l=>{var u,c;o.value.username=(u=l.data.name)!=null?u:"",o.value.email=(c=l.data.email)!=null?c:""}),V.get(`tournaments?user=${v.id}`).then(l=>{Object.assign(a,l.data)})}function e(){V.put("/me",o.value).then(l=>{var u,c;localStorage.setItem("token",l.data.token),v.name=(c=(u=o.value)==null?void 0:u.username)!=null?c:"",V.defaults.headers.common.Authorization=`Bearer ${l.data.token}`})}function r(l,u){V.put("/me/password",l).then(()=>{t.success("Password changed"),u&&u()})}function b(){m.name=m.description="",g.value=!0}function T(l,u){if(l.id){V.put(`/tournaments/${l.id}`,F.exports.pick(l,["name","description"])).then(c=>{});return}V.post("/tournaments",l).then(c=>{if(a.results===null){a.results=[c.data];return}a.results.unshift(c.data),q()}).catch(c=>{var H;t.error((H=c.response)==null?void 0:H.data.message)}).finally(()=>{u&&u()})}function q(){m.name=m.description="",g.value=!1}function G(l){g.value=!0,Object.assign(m,F.exports.pick(l,["id","name","description"]))}function L(l){V.delete(`/tournaments/${l}`).then(()=>{w()})}return(l,u)=>{const c=M,H=I,J=be,U=ue,K=he;return _(),y(P,null,[h("div",xe,[ye,Ve,o.value?(_(),y("form",{key:0,onSubmit:le(e,["prevent"])},[i(c,{modelValue:o.value.username,"onUpdate:modelValue":u[0]||(u[0]=x=>o.value.username=x),label:"Username",name:"username"},null,8,["modelValue"]),i(c,{modelValue:o.value.email,"onUpdate:modelValue":u[1]||(u[1]=x=>o.value.email=x),label:"Email",name:"email"},null,8,["modelValue"]),i(H,{class:"btn btn-theme-warning",type:"submit"},{default:f(()=>[ke]),_:1}),i(J,{onSubmit:r})],40,$e)):O("",!0),Se,Te,h("div",He,[i(H,{class:"btn btn-brand-primary",onClick:b},{default:f(()=>[Pe]),_:1})]),h("div",Ce,[s(a).results?(_(),y(P,{key:0},[s(a).results.length>0?(_(!0),y(P,{key:0},E(s(a).results,x=>{var D;return _(),j(U,{key:(D=x.id)!=null?D:0,tournament:x,"with-actions":"",onEdit:G,onDelete:L},null,8,["tournament"])}),128)):(_(),y("div",Ae," No Tournaments Found "))],64)):(_(),y(P,{key:1},E(4,x=>i(U,{key:x,tournament:null})),64))])]),i(K,{show:g.value,tournament:s(m),onClose:u[2]||(u[2]=x=>g.value=!1),onSubmit:T},null,8,["show","tournament"])],64)}}});export{Me as default};
